# Database Daemon

The Database Daemon was originally created to allow defining and
verifying the schema for discovery data written from Python scripts
and used in Javascript, and to ensure proper serialization of updates
to Elasticsearch (which does not support multi-document
transactions). It also maintains a single or dual timeline (as defined
in the table definition) of object versions in the index. The dual
timeline (allowing object versions to be anchored separately to an
`active` and a `current` timeline) was used in a previous iteration of
ContinuousC to allow verifying configuration updates before actually
committing them to production.

Now that ContinuousC data is written from Rust code, with schemas
fixed by the type definitions and Typescript and OpenAPI definitions
autogenerated from them, schema verification has become mostly
obsolete. The timeline handling and concurrent request serialization
functions could be extracted into a library that can then be
integrated directly into the Relation Graph Engine, avoiding the extra
processing required to go through the DBDaemon service. If the
database could be switched out for one with the necessary transaction
support, or a distributed in-memory cache were to be used, the
Relation Graph Engine could be made to be horizontally scalable.

## Repository structure

- Source/Node
  
  Contains code for connecting to the dbdaemon from Javascript. This
  was used in a previous iteration of ContinuousC, and is now
  obsolete.
  
- Source/Rust/dbdaemon-types

  Contains types shared with other crates outside this repository.

- Source/Rust/dbdaemon-api

  Contains the [API
  definitions](https://gitea.contc/ContinuousC/DBDaemon/src/branch/master/Source/Rust/dbdaemon-api/src/backend.rs),
  used as input for the `rpc` crate to generate definitions to connect
  to the Database Daemon from Rust, Python and Javascript.

- Source/Rust/dbdaemon

  Contains the actual daemon code.
